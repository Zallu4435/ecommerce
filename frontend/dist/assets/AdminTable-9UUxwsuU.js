import{u as P,bt as R,bu as E,aW as I,B as i,j as e,r as O,t as V,L as M}from"./index-DNwfBDY0.js";import{B as n}from"./StyledComponents-BbiIQNic.js";import{C as T}from"./ConfirmDeleteModal-CHDRD4Zv.js";import{S as _}from"./StatusDropdown-C-KKHdgd.js";const z=r=>{const a=P(),[y]=R(),[u]=E(),{refetch:b}=I();return{handleUpdate:async(d,o)=>{try{a(`update/${o}/${d}`)}catch(s){console.error("Update failed:",s),i.error("Failed to update. Please try again.")}},handleDelete:async(d,o)=>{var s;try{await y({entity:o,id:d}).unwrap(),o==="category"&&b(),o==="reviews"&&r&&await r(),i.success("Deleted successfully!")}catch(l){console.error("Delete failed:",l),i.error(((s=l==null?void 0:l.data)==null?void 0:s.message)||"Failed to delete. Please try again.")}},handleCreate:async(d,o)=>{try{a(`create/${d}`)}catch(s){console.error("Create failed:",s),i.error("Failed to create. Please try again.")}},handleBan:async(d,o)=>{var s;try{await u({entity:d,id:o}).unwrap(),r&&await r(),i.success("User status updated successfully!")}catch(l){console.error("Ban failed:",l),i.error(((s=l==null?void 0:l.data)==null?void 0:s.message)||"Failed to update user status. Please try again.")}},handleView:async(d,o)=>{try{a(`view/${o}/${d}`)}catch(s){console.error("view failed:",s),i.error("Failed to view details. Please try again.")}}}},x=({item:r,type:a,refetch:y})=>{var w,N,f,C,v,k,D,$,A,B,S;const{handleBan:u,handleDelete:b,handleUpdate:p,handleView:h}=z(y),[j,g]=O.useState(!1),[t,d]=O.useState(null),o=P(),s=c=>{d(c),g(!0)},l=()=>{g(!1),d(null)},L=async()=>{b(t.id?t.id:t._id,a==="categories"?"category":a),l()},F=(c,m,U)=>{o(`view/orders/${c}`,{state:{username:m,email:U}})};return e.jsxs(e.Fragment,{children:[e.jsxs("tr",{className:"dark:hover:bg-gray-800 border border-gray-600 hover:bg-slate-100",children:[a==="users"&&e.jsxs(e.Fragment,{children:[e.jsxs("td",{className:"px-6 py-4 w-[200px] overflow-hidden flex items-center gap-3",children:[e.jsx("img",{src:r.avatar||V,alt:"Profile",className:"w-12 h-12 rounded-full"}),e.jsx("strong",{className:"",children:r.name})]}),e.jsx("td",{className:"px-6 py-4 border border-gray-600",children:r.email}),e.jsx("td",{className:"px-6 py-4 border border-gray-600",children:r.role}),e.jsx("td",{className:"px-6 py-4 border border-gray-600",children:new Date(r.joinDate).toLocaleDateString()}),e.jsxs("td",{className:"px-6 flex py-4 gap-6",children:[e.jsx(n,{$borderColor:"#d97706",$textColor:"#d97706",$hoverColor:"white",onClick:()=>u("admin",r.id),children:r.isBlocked?"Unban":"Ban"}),e.jsx(n,{$borderColor:"#D4A017",$textColor:"#D4A017",$hoverColor:"white",onClick:()=>h(r.id,"users"),children:"View"})]})]}),a==="categories"&&e.jsxs(e.Fragment,{children:[e.jsx("td",{className:"px-6 py-4",children:r.categoryName}),e.jsx("td",{className:"px-6 py-4 border border-gray-600 max-w-[300px] truncate",title:r.categoryDescription,children:r.categoryDescription}),e.jsx("td",{className:"px-6 py-4 border border-gray-600",children:r.isOfferActive?e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-green-600",children:r.offerName}),e.jsxs("span",{className:"text-xs ml-1 bg-green-100 text-green-800 px-2 py-0.5 rounded-full",children:[r.categoryOffer,"%"]}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:r.endDate?`Ends: ${new Date(r.endDate).toLocaleDateString()}`:""})]}):e.jsx("span",{className:"text-gray-400 italic",children:"No Active Offer"})}),e.jsx("td",{className:"px-6 py-4 border border-gray-600",children:new Date(r.createdAt).toLocaleDateString()}),e.jsxs("td",{className:"px-6 py-[40px] flex gap-6",children:[e.jsx(n,{$borderColor:"#16a34a",$textColor:"#16a34a",$hoverColor:"white",onClick:()=>p(r._id,"category"),children:"Update"}),e.jsx(n,{$borderColor:"#B34D4D",$textColor:"#B34D4D",$hoverColor:"white",onClick:()=>s(r),children:"Delete"})]})]}),a==="orders"&&e.jsxs(e.Fragment,{children:[e.jsx("td",{className:"px-6 py-4",children:r.email}),e.jsx("td",{className:"px-6 py-4 border border-gray-600",children:r.ordersCount}),e.jsx("td",{className:"px-6 py-4 border border-gray-600",children:r.totalAmount?(w=r.totalAmount)==null?void 0:w.toFixed(2):r.totalAmount}),e.jsx("td",{className:"px-6 py-4 border border-gray-600",children:r.lastOrderDate}),e.jsx("td",{className:"px-6 flex text-nowrap py-4 gap-6",children:e.jsx(n,{$borderColor:"#D4A017",$textColor:"#D4A017",$hoverColor:"white",onClick:()=>F(r._id,r.username,r.email),children:"View Individual Orders"})})]}),a==="coupons"&&e.jsxs(e.Fragment,{children:[e.jsx("td",{className:"px-6 py-4 border border-gray-600",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-mono bg-gray-100 dark:bg-gray-700 px-2 py-1 rounded text-sm font-bold text-gray-700 dark:text-gray-300",children:r.couponCode||"N/A"}),e.jsx("button",{onClick:()=>{navigator.clipboard.writeText(r.couponCode)},title:"Copy Code",className:"text-gray-400 hover:text-blue-500 transition-colors",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),e.jsx("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})]})})]})}),e.jsx("td",{className:"px-6 py-4 border border-gray-600",children:e.jsx("div",{className:"font-medium text-gray-800 dark:text-gray-200",children:r.title||"N/A"})}),e.jsx("td",{className:"px-6 py-4 border border-gray-600",children:e.jsx("span",{className:"bg-blue-100 text-blue-800 text-xs font-semibold px-2.5 py-0.5 rounded dark:bg-blue-200 dark:text-blue-900",children:r.discount?`${r.discount}%`:"N/A"})}),e.jsx("td",{className:"px-6 py-4 border border-gray-600",children:(()=>{const c=new Date(r.expiry)<new Date,m=r.usageLimit!==null&&r.usageCount>=r.usageLimit;return c?e.jsx("span",{className:"text-red-700 bg-red-100 border border-red-200 px-2 py-1 rounded text-xs font-bold uppercase tracking-wide",children:"Expired"}):m?e.jsx("span",{className:"text-orange-700 bg-orange-100 border border-orange-200 px-2 py-1 rounded text-xs font-bold uppercase tracking-wide",children:"Sold Out"}):e.jsx("span",{className:"text-green-700 bg-green-100 border border-green-200 px-2 py-1 rounded text-xs font-bold uppercase tracking-wide",children:"Active"})})()}),e.jsx("td",{className:"px-6 py-4 border border-gray-600 text-sm",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-medium",children:r.expiry?new Date(r.expiry).toLocaleDateString():"N/A"}),e.jsx("span",{className:"text-xs text-gray-500",children:r.expiry?new Date(r.expiry).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):""})]})}),e.jsxs("td",{className:"px-6 flex py-4 gap-3",children:[e.jsx(n,{$borderColor:"#d97706",$textColor:"#d97706",$hoverColor:"white",onClick:()=>h(r.id,"coupons"),className:"!px-3 !py-1 text-xs",children:"View"}),e.jsx(n,{$borderColor:"#16a34a",$textColor:"#16a34a",$hoverColor:"white",onClick:()=>p(r.id,"coupons"),className:"!px-3 !py-1 text-xs",children:"Edit"}),e.jsx(n,{$borderColor:"#B34D4D",$textColor:"#B34D4D",$hoverColor:"white",onClick:()=>s(r),className:"!px-3 !py-1 text-xs",children:"Delete"})]})]}),a==="products"&&e.jsxs(e.Fragment,{children:[e.jsx("td",{className:"px-6 py-4 border border-gray-600",children:r.productName}),e.jsx("td",{className:"px-6 py-4 border border-gray-600",children:r.category}),e.jsx("td",{className:"px-6 py-4 border border-gray-600",children:r.brand}),e.jsxs("td",{className:"px-6 py-4 border border-gray-600",children:["₹",r.basePrice||r.originalPrice]}),e.jsxs("td",{className:"px-6 py-4 border border-gray-600",children:["₹",r.baseOfferPrice!==void 0?r.baseOfferPrice:r.offerPrice||"0"]}),e.jsxs("td",{className:"px-6 flex py-4 gap-6",children:[e.jsx(n,{$borderColor:"#d97706",$textColor:"#d97706",$hoverColor:"white",onClick:()=>h(r.id,"products"),children:"View"}),e.jsx(n,{$borderColor:"#16a34a",$textColor:"#16a34a",$hoverColor:"white",onClick:()=>p(r.id,"products"),children:"Update"}),e.jsx(n,{$borderColor:"#B34D4D",$textColor:"#B34D4D",$hoverColor:"white",onClick:()=>s(r),children:"Delete"})]})]}),a==="allOrders"&&e.jsxs(e.Fragment,{children:[e.jsx("td",{className:"px-6 py-4 border border-gray-600 font-medium whitespace-nowrap",children:r.orderId}),e.jsx("td",{className:"px-6 py-4 border border-gray-600",children:e.jsxs("div",{className:"flex -space-x-2 overflow-hidden",children:[(N=r.productImages)==null?void 0:N.slice(0,3).map((c,m)=>e.jsx("img",{src:c,className:"inline-block h-10 w-10 rounded-lg ring-2 ring-white dark:ring-gray-800 object-cover shadow-sm bg-gray-50 dark:bg-gray-700",alt:"Product"},m)),r.itemCount>3&&e.jsxs("div",{className:"flex items-center justify-center h-10 w-10 rounded-lg ring-2 ring-white dark:ring-gray-800 bg-gray-100 dark:bg-gray-700 text-[10px] font-bold text-gray-500",children:["+",r.itemCount-3]})]})}),e.jsx("td",{className:"px-6 py-4 border border-gray-600 min-w-[200px]",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex-shrink-0 h-9 w-9 bg-blue-50 dark:bg-blue-900/30 rounded-full flex items-center justify-center text-blue-600 dark:text-blue-400 font-bold text-sm",children:(C=(f=r.userName)==null?void 0:f[0])==null?void 0:C.toUpperCase()}),e.jsxs("div",{className:"flex flex-col min-w-0",children:[e.jsx("span",{className:"font-semibold text-gray-900 dark:text-gray-100 truncate text-sm",children:r.userName}),e.jsx("span",{className:"text-[11px] text-gray-500 dark:text-gray-400 truncate",children:r.userEmail})]})]})}),e.jsxs("td",{className:"px-6 py-4 border border-gray-600 text-sm whitespace-nowrap text-center",children:[e.jsx("span",{className:"font-bold text-gray-700 dark:text-gray-300",children:r.itemCount})," items"]}),e.jsxs("td",{className:"px-6 py-4 border border-gray-600 whitespace-nowrap font-black text-gray-900 dark:text-gray-100",children:["₹",(v=r.totalAmount)==null?void 0:v.toFixed(2)]}),e.jsx("td",{className:"px-6 py-4 border border-gray-600 min-w-[140px] text-center",children:e.jsx("span",{className:`inline-block px-3 py-1.5 text-[10px] font-black rounded-full uppercase tracking-widest border ${((k=_[r.orderStatus])==null?void 0:k.color)||"bg-gray-100 text-gray-700"}`,children:r.orderStatus})}),e.jsx("td",{className:"px-6 py-4 border border-gray-600 text-[11px] font-semibold text-gray-500 whitespace-nowrap",children:new Date(r.orderDate).toLocaleDateString("en-IN",{day:"numeric",month:"short",year:"numeric"})}),e.jsx("td",{className:"px-6 py-4 border border-gray-600 whitespace-nowrap",children:e.jsx(n,{$borderColor:"#3b82f6",$textColor:"#3b82f6",$hoverColor:"white",onClick:()=>o(`/admin/order-details/${r._id}`),className:"!px-3 !py-1.5 text-[11px] font-black uppercase tracking-tighter",children:"Details"})})]}),a==="reviews"&&e.jsxs(e.Fragment,{children:[e.jsx("td",{className:"px-6 py-4 border border-gray-600",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:(D=r.productId)==null?void 0:D.image,alt:"Prod",className:"w-10 h-10 object-cover rounded"}),e.jsx("span",{className:"text-sm font-medium max-w-[150px] truncate",title:($=r.productId)==null?void 0:$.productName,children:(A=r.productId)==null?void 0:A.productName})]})}),e.jsx("td",{className:"px-6 py-4 border border-gray-600",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-semibold text-sm",children:((B=r.userId)==null?void 0:B.username)||"Unknown"}),e.jsx("span",{className:"text-xs text-gray-400",children:(S=r.userId)==null?void 0:S.email})]})}),e.jsx("td",{className:"px-6 py-4 border border-gray-600",children:e.jsxs("span",{className:`font-bold ${r.rating>=4?"text-green-500":r.rating>=3?"text-yellow-500":"text-red-500"}`,children:[r.rating," / 5"]})}),e.jsx("td",{className:"px-6 py-4 border border-gray-600 max-w-[250px]",children:e.jsx("p",{className:"truncate text-sm text-gray-300",title:r.review,children:r.review})}),e.jsx("td",{className:"px-6 py-4 border border-gray-600 text-sm",children:new Date(r.createdAt).toLocaleDateString()}),e.jsx("td",{className:"px-6 flex py-4 gap-6",children:e.jsx(n,{$borderColor:"#B34D4D",$textColor:"#B34D4D",$hoverColor:"white",onClick:()=>s(r),children:"Delete"})})]})]},r.id),e.jsx(T,{show:j,onClose:l,onConfirm:L,itemName:(t==null?void 0:t.productName)||(t==null?void 0:t.categoryName)||(t==null?void 0:t.couponCode)})]})},W={users:{headers:["Username","Email","Role","Join Date","Actions"],rowRenderer:(r,a)=>e.jsx(x,{item:r,type:"users",refetch:a})},categories:{headers:["Category Name","Category Description","Active Offer","Created At","Actions"],rowRenderer:(r,a)=>e.jsx(x,{item:r,type:"categories",refetch:a})},orders:{headers:["User Email","Total Orders","Total Amount","Last Order Date","Actions"],rowRenderer:(r,a)=>e.jsx(x,{item:r,type:"orders",refetch:a})},coupons:{headers:["Code","Title","Discount","Status","Valid Until","Actions"],rowRenderer:(r,a)=>e.jsx(x,{item:r,type:"coupons",refetch:a})},products:{headers:["Product Name","Category","Brand","Base Price","Base Offer Price","Actions"],rowRenderer:(r,a)=>e.jsx(x,{item:r,type:"products",refetch:a})},allOrders:{headers:["Order ID","Product","Customer","Items","Amount","Status","Date","Actions"],rowRenderer:(r,a)=>e.jsx(x,{item:r,type:"allOrders",refetch:a})},reviews:{headers:["Product","User","Rating","Review","Date","Actions"],rowRenderer:(r,a)=>e.jsx(x,{item:r,type:"reviews",refetch:a})}},q=({type:r,data:a={},isLoading:y,isError:u,search:b,setSearch:p,refetch:h})=>{const j={users:"Users",categories:"Categories",coupons:"Coupons",orders:"Orders",products:"Products",allOrders:"Orders",reviews:"Reviews"},g=a!=null&&a[r]?a==null?void 0:a[r]:a,{headers:t,rowRenderer:d}=W[r],o=Array.isArray(g)?g:[];return e.jsxs("div",{children:[e.jsx("div",{className:"mb-6 sticky overflow-hidden top-0 z-10 dark:bg-gray-900 bg-orange-50/80 backdrop-blur-sm py-4",children:e.jsxs("div",{className:"relative group",children:[e.jsx("input",{type:"text",placeholder:`Search ${j[r]} by ID, name, or other details...`,className:"w-full p-3.5 pl-4 rounded-xl border border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition-all placeholder:text-gray-400 dark:placeholder:text-gray-500",value:b,onChange:s=>p(s.target.value)}),e.jsx("div",{className:"absolute right-4 top-1/2 -translate-y-1/2 text-gray-400 pointer-events-none",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})})]})}),e.jsx("div",{className:"overflow-y-auto max-h-[600px] scrollbar-hidden",children:e.jsxs("table",{className:"w-full table-auto border-collapse border border-gray-600",children:[e.jsx("thead",{className:"bg-gray-100 dark:bg-gray-900 sticky top-0 z-20 border-t-4 border-gray-600",children:e.jsx("tr",{children:t.map((s,l)=>e.jsx("th",{className:"px-6 py-4 text-left whitespace-nowrap",children:s},l))})}),e.jsx("tbody",{children:y?e.jsx("tr",{children:e.jsx("td",{colSpan:t.length,className:"text-center py-4",children:e.jsx(M,{})})}):u?e.jsx("tr",{children:e.jsx("td",{colSpan:t.length,className:"text-center py-4",children:"Error loading state"})}):o.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:t.length,className:"text-center py-4",children:`No ${j[r]} Found`||"No results found"})}):o.map(s=>d(s,h))})]})})]})};export{q as A,z as u};
