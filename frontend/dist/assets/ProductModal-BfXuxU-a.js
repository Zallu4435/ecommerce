import{S as s,r as d,j as e,X as L,bh as S}from"./index-DNwfBDY0.js";import{u as E}from"./usePreventBodyScroll-D2l0Zfsl.js";import{U as w}from"./users-nAU_wbTa.js";import{P as C}from"./package-CJrhpnXf.js";const v=s.union([s.string(),s.number()]).transform(r=>typeof r=="string"?Number(r):r).refine(r=>!isNaN(r),{message:"Must be a valid number"}),A=s.object({couponCode:s.string().min(3,"Coupon code must be at least 3 characters").max(50,"Coupon code cannot exceed 50 characters").regex(/^[A-Z0-9_-]+$/i,"Coupon code can only contain letters, numbers, hyphens, and underscores"),title:s.string().min(3,"Title must be at least 3 characters").max(100,"Title cannot exceed 100 characters"),description:s.string().min(10,"Description must be at least 10 characters").max(500,"Description cannot exceed 500 characters"),discount:v.refine(r=>r>=1&&r<=70,{message:"Discount must be between 1 and 70 percent"}),minAmount:v.refine(r=>r>=500&&r<=1e5,{message:"Minimum purchase amount must be between ₹500 and ₹1,00,000"}),maxAmount:v.refine(r=>r>=1&&r<=5e3,{message:"Maximum discount amount must be between ₹1 and ₹5,000"}),expiry:s.string().min(1,"Expiry date is required").refine(r=>{const n=new Date(r),o=new Date;if(o.setHours(0,0,0,0),!(n instanceof Date)||isNaN(n)||n<=o)return!1;const l=new Date;return l.setFullYear(l.getFullYear()+2),!(n>l)},{message:"Expiry must be a future date (max 2 years ahead)"}),usageLimit:s.union([s.string(),s.number()]).optional().transform(r=>r===""||r===null||r===void 0?null:typeof r=="string"?Number(r):r).refine(r=>r==null?!0:Number.isInteger(r)&&r>0,{message:"Usage limit must be a positive integer or leave empty for unlimited"}),perUserLimit:s.union([s.string(),s.number()]).optional().transform(r=>r===""||r===null||r===void 0?1:typeof r=="string"?Number(r):r).refine(r=>Number.isInteger(r)&&r>=1&&r<=5,{message:"Per user limit must be between 1 and 5"})}).refine(r=>Number(r.minAmount)>=Number(r.maxAmount)*5,{message:"Minimum purchase amount must be at least 5 times the maximum discount amount",path:["minAmount"]}),I=({showModal:r,setShowModal:n,users:o,handleUserSelect:l,selectedUsers:i,loadMoreUsers:b,hasMoreUsers:x,isUserFetching:c})=>{const[g,f]=d.useState(""),[h,p]=d.useState(1);E(r);const y=d.useCallback(()=>{!c&&x&&(p(a=>a+1),b(h+1))},[c,x,b,h]);if(d.useEffect(()=>{const a=m=>{const{scrollTop:k,clientHeight:N,scrollHeight:j}=m.target;j-k<=N*1.5&&y()},t=document.getElementById("user-modal-content");return t&&t.addEventListener("scroll",a),()=>{t&&t.removeEventListener("scroll",a)}},[y]),!r)return null;const u=o==null?void 0:o.filter(a=>a.email.toLowerCase().includes(g.toLowerCase()));return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm flex justify-center items-center z-50 p-4",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl w-full max-w-2xl max-h-[85vh] overflow-hidden shadow-2xl border border-gray-200 dark:border-gray-700",children:[e.jsx("div",{className:"bg-gradient-to-r from-orange-500 to-orange-600 dark:from-blue-600 dark:to-blue-700 p-6",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg",children:e.jsx(w,{className:"w-6 h-6 text-orange-600 dark:text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-white",children:"Select Users"}),e.jsxs("p",{className:"text-orange-100 dark:text-blue-100 text-sm",children:[i.length," user",i.length!==1?"s":""," selected"]})]})]}),e.jsx("button",{onClick:()=>n(!1),className:"text-white hover:bg-white hover:bg-opacity-20 p-2 rounded-lg transition-colors",children:e.jsx(L,{className:"w-6 h-6"})})]})}),e.jsx("div",{className:"p-4 bg-gray-50 dark:bg-gray-900 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"relative",children:[e.jsx(S,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search users by email...",value:g,onChange:a=>f(a.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-800 dark:text-white focus:outline-none focus:ring-2 focus:ring-orange-500 dark:focus:ring-blue-500 transition-all"})]})}),e.jsxs("div",{id:"user-modal-content",className:"p-4 overflow-y-auto",style:{maxHeight:"calc(85vh - 280px)"},children:[u&&u.length>0?e.jsx("div",{className:"space-y-2",children:u.map(a=>{const t=i.some(m=>m.userId===a.id);return e.jsx("div",{onClick:()=>l(a.id,a.email),className:`p-4 rounded-lg cursor-pointer transition-all border-2 ${t?"bg-orange-50 dark:bg-blue-900 border-orange-500 dark:border-blue-500":"bg-white dark:bg-gray-700 border-gray-200 dark:border-gray-600 hover:border-orange-300 dark:hover:border-blue-400"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-5 h-5 rounded border-2 flex items-center justify-center transition-all ${t?"bg-orange-500 dark:bg-blue-500 border-orange-500 dark:border-blue-500":"border-gray-300 dark:border-gray-500"}`,children:t&&e.jsx("svg",{className:"w-3 h-3 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})}),e.jsx("span",{className:`font-medium ${t?"text-orange-900 dark:text-blue-100":"text-gray-800 dark:text-gray-100"}`,children:a.email})]})},a.id)})}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(w,{className:"w-16 h-16 text-gray-300 dark:text-gray-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:g?"No users found matching your search":"No users available"})]}),c&&e.jsxs("div",{className:"text-center py-4",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-4 border-gray-300 border-t-orange-500 dark:border-t-blue-500"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2 text-sm",children:"Loading more users..."})]})]}),e.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-900 border-t border-gray-200 dark:border-gray-700 flex justify-end gap-3",children:[e.jsx("button",{onClick:()=>n(!1),className:"px-6 py-2.5 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 font-medium rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:()=>n(!1),className:"px-6 py-2.5 bg-orange-500 dark:bg-blue-600 text-white font-medium rounded-lg hover:bg-orange-600 dark:hover:bg-blue-700 transition-colors shadow-lg",children:"Confirm Selection"})]})]})})},B=({showModal:r,setShowModal:n,products:o,handleProductSelect:l,selectedProducts:i,loadMoreProducts:b,hasMoreProducts:x,isProductFetching:c})=>{const[g,f]=d.useState(""),[h,p]=d.useState(1);E(r);const y=d.useCallback(()=>{!c&&x&&(p(a=>a+1),b(h+1))},[c,x,b,h]);if(d.useEffect(()=>{const a=m=>{const{scrollTop:k,clientHeight:N,scrollHeight:j}=m.target;j-k<=N*1.5&&y()},t=document.getElementById("product-modal-content");return t&&t.addEventListener("scroll",a),()=>{t&&t.removeEventListener("scroll",a)}},[y]),!r)return null;const u=o==null?void 0:o.filter(a=>a.productName.toLowerCase().includes(g.toLowerCase()));return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm flex justify-center items-center z-50 p-4",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl w-full max-w-2xl max-h-[85vh] overflow-hidden shadow-2xl border border-gray-200 dark:border-gray-700",children:[e.jsx("div",{className:"bg-gradient-to-r from-orange-500 to-orange-600 dark:from-blue-600 dark:to-blue-700 p-6",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg",children:e.jsx(C,{className:"w-6 h-6 text-orange-600 dark:text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-white",children:"Select Products"}),e.jsxs("p",{className:"text-orange-100 dark:text-blue-100 text-sm",children:[i.length," product",i.length!==1?"s":""," selected"]})]})]}),e.jsx("button",{onClick:()=>n(!1),className:"text-white hover:bg-white hover:bg-opacity-20 p-2 rounded-lg transition-colors",children:e.jsx(L,{className:"w-6 h-6"})})]})}),e.jsx("div",{className:"p-4 bg-gray-50 dark:bg-gray-900 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"relative",children:[e.jsx(S,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search products by name...",value:g,onChange:a=>f(a.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-800 dark:text-white focus:outline-none focus:ring-2 focus:ring-orange-500 dark:focus:ring-blue-500 transition-all"})]})}),e.jsxs("div",{id:"product-modal-content",className:"p-4 overflow-y-auto",style:{maxHeight:"calc(85vh - 280px)"},children:[u&&u.length>0?e.jsx("div",{className:"space-y-2",children:u.map(a=>{const t=i.some(m=>m.productId===a.id);return e.jsx("div",{onClick:()=>l(a.id,a.productName),className:`p-4 rounded-lg cursor-pointer transition-all border-2 ${t?"bg-orange-50 dark:bg-blue-900 border-orange-500 dark:border-blue-500":"bg-white dark:bg-gray-700 border-gray-200 dark:border-gray-600 hover:border-orange-300 dark:hover:border-blue-400"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-5 h-5 rounded border-2 flex items-center justify-center transition-all ${t?"bg-orange-500 dark:bg-blue-500 border-orange-500 dark:border-blue-500":"border-gray-300 dark:border-gray-500"}`,children:t&&e.jsx("svg",{className:"w-3 h-3 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})}),e.jsx("span",{className:`font-medium ${t?"text-orange-900 dark:text-blue-100":"text-gray-800 dark:text-gray-100"}`,children:a.productName})]})},a.id)})}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(C,{className:"w-16 h-16 text-gray-300 dark:text-gray-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:g?"No products found matching your search":"No products available"})]}),c&&e.jsxs("div",{className:"text-center py-4",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-4 border-gray-300 border-t-orange-500 dark:border-t-blue-500"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2 text-sm",children:"Loading more products..."})]})]}),e.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-900 border-t border-gray-200 dark:border-gray-700 flex justify-end gap-3",children:[e.jsx("button",{onClick:()=>n(!1),className:"px-6 py-2.5 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 font-medium rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:()=>n(!1),className:"px-6 py-2.5 bg-orange-500 dark:bg-blue-600 text-white font-medium rounded-lg hover:bg-orange-600 dark:hover:bg-blue-700 transition-colors shadow-lg",children:"Confirm Selection"})]})]})})};export{B as P,I as U,A as c};
