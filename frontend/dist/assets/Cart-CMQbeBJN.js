import{r as h,u as O,a as P,j as e,F as R,b as I,c as Q,B as y,d as q,e as T,L as z,f as B}from"./index-DNwfBDY0.js";const E=({item:t,onRemove:l})=>{const[s,a]=h.useState((t==null?void 0:t.quantity)||1),[d,c]=h.useState(!1),u=O(),[b]=P(),{productId:p,originalPrice:g,productName:o,cartItemId:m,productImage:x,totalReviews:j,averageRating:f,stockQuantity:r}=t,i=async k=>{try{const n=await b({cartItemId:m,quantity:k});n.error?n.error.status==400?(c(!0),y.error("Out of Stock!")):y.error("Failed to update quantity. Please try again."):(a(k),c(!1))}catch(n){console.error("Error updating quantity:",n),y.error("Failed to update quantity. Please try again.")}},L=()=>{!d&&s<7?i(s+1):d&&y.error("Out of Stock!")},M=()=>{s>1&&i(s-1)},v=()=>(g*s).toFixed(2),w=()=>u(`/product/${p}`),S=()=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex items-center mr-2",children:[...Array(5)].map((k,n)=>{const N=f;return n<Math.floor(N)?e.jsx(R,{className:"text-yellow-500 text-sm"},n):n<Math.ceil(N)&&N%1!==0?e.jsx(I,{className:"text-yellow-500 text-sm"},n):e.jsx(Q,{className:"text-gray-300 text-sm"},n)})}),e.jsxs("span",{className:"text-sm text-gray-500 ml-2",children:["(",j||0," reviews)"]})]}),C=()=>e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("button",{className:"px-3 py-1 bg-gray-200 dark:bg-gray-600 border rounded-lg hover:bg-gray-300 dark:hover:bg-gray-500 text-gray-800 dark:text-gray-100",onClick:M,disabled:r==0,children:"-"}),e.jsx("span",{className:"px-4 py-1 text-gray-800 dark:text-gray-100",children:s}),e.jsx("button",{className:"px-3 py-1 bg-gray-200 dark:bg-gray-600 border rounded-lg hover:bg-gray-300 dark:hover:bg-gray-500 text-gray-800 dark:text-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",onClick:L,disabled:d||s>=7||r==0,children:"+"})]}),F=()=>e.jsx("span",{className:`px-2 py-1 rounded-md text-sm font-semibold ${d||r==0?"text-red-500 bg-red-100 dark:bg-red-900 animate-pulse":"text-green-500 bg-green-100 dark:bg-green-900"}`,children:d||r==0?"Out of Stock":"In Stock"});return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"md:hidden p-4 bg-white dark:bg-gray-800 rounded-lg shadow-md mb-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{className:"flex gap-4",children:[e.jsx("img",{src:x,className:"h-20 w-20 rounded-lg cursor-pointer object-cover",alt:o,onClick:w}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-900 dark:text-gray-100 mb-2",children:o}),(t.color||t.size||t.gender)&&e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-2",children:[t.color,t.size,t.gender==="Male"?"Boy":t.gender==="Female"?"Girl":t.gender].filter(Boolean).join(" | ")}),e.jsx(S,{})]})]}),e.jsx("button",{className:"text-red-500 font-bold",onClick:()=>l(m),children:"❌"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-300",children:"Status:"}),e.jsx(F,{})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-300",children:"Price:"}),e.jsxs("span",{className:"text-gray-900 dark:text-gray-100",children:["₹ ",g]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-300",children:"Quantity:"}),e.jsx(C,{})]}),e.jsxs("div",{className:"flex justify-between items-center font-semibold",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-300",children:"Subtotal:"}),e.jsxs("span",{className:"text-gray-900 dark:text-gray-100",children:["₹ ",v()]})]})]})]}),e.jsxs("tr",{className:"hidden md:table-row hover:bg-gray-100 dark:hover:bg-gray-700 transition",children:[e.jsx("td",{className:"px-6 py-4 border-b text-center",children:e.jsx("button",{className:"text-red-500 font-bold hover:underline",onClick:()=>l(m),children:"❌ Remove"})}),e.jsxs("td",{className:"px-6 py-4 border-b flex items-center gap-4",children:[e.jsx("img",{src:x,className:"h-[60px] w-[60px] rounded-lg cursor-pointer object-cover",alt:o,onClick:w}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-900 dark:text-gray-100",children:o}),(t.color||t.size||t.gender)&&e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:[t.color,t.size,t.gender==="Male"?"Boy":t.gender==="Female"?"Girl":t.gender].filter(Boolean).join(" | ")}),e.jsx(S,{})]})]}),e.jsx("td",{className:"px-6 py-4 border-b text-center",children:e.jsx(F,{})}),e.jsx("td",{className:"px-6 py-4 border-b text-center",children:e.jsx(C,{})}),e.jsxs("td",{className:"px-6 py-4 border-b text-center text-gray-900 dark:text-gray-100",children:["₹ ",g]}),e.jsxs("td",{className:"px-6 py-4 border-b text-center text-gray-900 dark:text-gray-100",children:["₹ ",v()]})]})]})},H=({type:t,data:l,onRemove:s})=>{const a=()=>e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 text-center border-b bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-100",children:"Remove"}),e.jsx("th",{className:"px-6 py-4 text-left border-b bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-100",children:"Product Name"}),e.jsx("th",{className:"px-6 py-4 text-center border-b bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-100",children:"Stock"}),e.jsx("th",{className:"px-6 py-4 text-center border-b bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-100",children:"Quantity"}),e.jsx("th",{className:"px-6 py-4 text-center border-b bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-100",children:"Price"}),e.jsx("th",{className:"px-6 py-4 text-center border-b bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-100",children:"Subtotal"})]}),d=()=>!l||l.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"px-6 py-4 text-center text-gray-500 dark:text-gray-400",children:"No items found in the cart."})}):l.map(c=>e.jsx(E,{item:c,onRemove:s},c.id));return e.jsxs("div",{className:"flex flex-col items-center justify-center md:m-10 m-4 bg-white dark:bg-gray-800 shadow-lg rounded-lg p-6",children:[t==="cart"&&e.jsx("h2",{className:"text-4xl font-bold text-gray-800 dark:text-gray-100 mb-6 text-center",children:"Your Cart"}),e.jsx("div",{className:"overflow-x-auto w-full max-w-6xl hidden md:block",children:e.jsxs("table",{className:"w-full table-auto border-collapse border border-gray-300 dark:border-gray-700",children:[e.jsx("thead",{children:a()}),e.jsx("tbody",{children:d()})]})}),e.jsx("div",{className:"grid gap-6 w-full md:hidden mt-6",children:d()})]})},G=()=>{const t=O(),[l,s]=h.useState(!1),{data:a=[],error:d,isLoading:c}=q(),[u]=T(),b=async r=>{try{await u(r)}catch(i){console.error("Failed to remove item:",i)}},p=()=>a?a==null?void 0:a.reduce((r,i)=>r+i.originalPrice*i.quantity,0):0,g=r=>(r*.08).toFixed(2),o=15,m=r=>(parseFloat(r)+parseFloat(g(r))+o).toFixed(2),x=p();if(h.useEffect(()=>{a&&a.some(r=>r.stockQuantity<=(r==null?void 0:r.quantity))?s(!0):s(!1)},[a]),c)return e.jsx(z,{});if(d)return e.jsx("div",{children:"Error loading cart data"});const j=()=>{if(l)return;const r=m(x);t("/checkout",{state:{cartItems:a,total:r}})},f=!a||a.length===0;return e.jsx("div",{className:"bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-gray-100 min-h-screen",children:f?e.jsxs("div",{className:"max-w-7xl mx-auto flex flex-col items-center justify-center py-24 px-6",children:[e.jsx("div",{className:"w-20 h-20 rounded-full bg-green-50 dark:bg-gray-700 flex items-center justify-center shadow-inner",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:"w-10 h-10 text-green-600 dark:text-green-400",children:e.jsx("path",{d:"M2.25 3.75A.75.75 0 013 3h1.5a.75.75 0 01.728.568L5.59 6h13.41a.75.75 0 01.728.932l-1.5 6A.75.75 0 0117.5 13.5H7.03l.375 1.5H18a.75.75 0 010 1.5H6.75a.75.75 0 01-.728-.568L4.16 4.5H3a.75.75 0 01-.75-.75zM9 19.5a1.5 1.5 0 100 3 1.5 1.5 0 000-3zm7.5 1.5a1.5 1.5 0 110 3 1.5 1.5 0 010-3z"})})}),e.jsx("h2",{className:"mt-6 text-2xl font-semibold text-gray-800 dark:text-gray-100",children:"Your cart is empty"}),e.jsx("p",{className:"mt-2 text-gray-600 dark:text-gray-400 max-w-md text-center",children:"Looks like you haven’t added anything yet. Explore our products and add your favorites."}),e.jsx("div",{className:"mt-6",children:e.jsxs(B,{to:"/shop",className:"inline-flex items-center gap-2 px-5 py-3 rounded-md bg-blue-600 text-white hover:bg-blue-700 transition-all transform hover:scale-105 dark:bg-blue-700 dark:hover:bg-blue-600",children:["Start shopping",e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17.25 8.25L21 12m0 0l-3.75 3.75M21 12H3"})})]})})]}):e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-11 gap-6 p-6",children:[e.jsx("div",{className:"col-span-1 lg:col-span-8",children:e.jsx(H,{type:"cart",data:a,onRemove:b})}),e.jsxs("div",{className:"p-8 bg-white h-[540px] dark:bg-gray-800 rounded-lg shadow-xl lg:mt-10 md:w-[350px] w-[300px] lg:col-span-3 mx-auto lg:mx-0 mt-6",children:[e.jsx("h2",{className:"text-2xl font-semibold mb-6 text-gray-800 dark:text-gray-100",children:"Cart Total"}),e.jsxs("div",{className:"mb-4 flex justify-between text-gray-700 dark:text-gray-300",children:[e.jsx("span",{className:"font-medium",children:"Subtotal"}),e.jsxs("span",{className:"font-medium",children:["₹ ",x.toFixed(2)]})]}),e.jsxs("div",{className:"mb-4 flex justify-between text-gray-700 dark:text-gray-300",children:[e.jsx("span",{className:"font-medium",children:"Tax (8%)"}),e.jsxs("span",{className:"font-medium",children:["₹ ",g(x)]})]}),e.jsxs("div",{className:"mb-4 flex justify-between text-gray-700 dark:text-gray-300",children:[e.jsx("span",{className:"font-medium",children:"Shipping"}),e.jsxs("span",{className:"font-medium",children:["₹ ",o.toFixed(2)]})]}),e.jsx("hr",{className:"my-4 border-gray-300 dark:border-gray-600"}),e.jsxs("div",{className:"mb-6 flex justify-between text-gray-800 dark:text-gray-100 text-lg font-bold",children:[e.jsx("span",{children:"Total"}),e.jsxs("span",{children:["₹ ",m(x)]})]}),e.jsx("button",{onClick:j,disabled:l,className:`w-full py-3 ${l?"bg-gray-400 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700 transition-all transform hover:scale-105 dark:bg-blue-700 dark:hover:bg-blue-600"} rounded-md mt-5`,children:"Proceed to Checkout"}),l&&e.jsxs("div",{className:"mt-4 p-4 bg-red-50 dark:bg-red-900 border border-red-400 text-red-800 dark:text-red-300 rounded-md shadow-md",children:[e.jsx("h3",{className:"text-lg font-bold mb-2",children:"Attention!"}),e.jsxs("p",{className:"text-sm",children:["Some items in your cart are ",e.jsx("strong",{children:"out of stock"}),". Please remove them to proceed with the checkout."]})]})]})]})})};export{G as default};
