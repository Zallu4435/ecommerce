import{u as I,r as C,be as E,H as A,aW as S,j as e,at as d,I as B,bj as b,B as y}from"./index-DNwfBDY0.js";import{I as O,V,p as U}from"./VariantBuilder-Do_vONtW.js";import{I as c,L as n,a as o,T as L}from"./StyledComponents-BbiIQNic.js";import{A as R}from"./arrow-left-CUel7EGd.js";import{U as T}from"./upload-D2_odXxp.js";import"./index.module-DWjB8usZ.js";import"./tslib.es6-D2mrdk48.js";import"./zoom-out-62RsYA8A.js";import"./ConfirmDeleteModal-CHDRD4Zv.js";import"./usePreventBodyScroll-D2l0Zfsl.js";import"./plus-C5cYjQOd.js";import"./trash-2-D6jt9bEq.js";const Y=()=>{const u=I(),[h,p]=C.useState(!1),[N]=E(),{control:t,handleSubmit:f,setValue:W,formState:{errors:a},watch:x}=A({resolver:B(U),defaultValues:{variants:[]}}),{data:g}=S(),k=(g==null?void 0:g.categories)||[],w=async(r,s)=>{var l;s.preventDefault(),p(!0);try{if(r.image){const i=await b(r.image);r.image=i.secureUrl,r.imagePublicId=i.publicId}if(r.variants&&r.variants.length>0){const i=await Promise.all(r.variants.map(async m=>{if(m.image&&(typeof m.image!="string"||m.image.startsWith("data:image"))){const j=await b(m.image);return{...m,image:j.secureUrl,imagePublicId:j.publicId}}return m}));r.variants=i}await N({entity:"products",data:r}).unwrap(),y.success("Product added successfully!"),u(-1)}catch(i){console.error("Error during form submission:",i),y.error(((l=i==null?void 0:i.data)==null?void 0:l.message)||"An error occurred")}finally{p(!1)}},P=x("basePrice"),v=x("baseOfferPrice");return e.jsx("div",{className:"dark:bg-black min-h-screen flex mt-10 items-center justify-center",children:e.jsxs("div",{className:"w-full max-w-[1300px] dark:bg-gray-900 bg-orange-50 p-6 md:p-8 shadow-md",children:[e.jsxs("div",{className:"flex justify-between mb-6",children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold mb-6 dark:text-gray-400 text-gray-700",children:"Add Product"}),e.jsxs("button",{onClick:()=>u(-1),className:"flex items-center text-gray-600 hover:text-gray-800 dark:text-gray-300 dark:hover:text-white",children:[e.jsx(R,{className:"mr-2"}),e.jsx("span",{children:"Back to Products"})]})]}),e.jsxs("form",{onSubmit:f(w),children:[e.jsxs("div",{className:"grid md:grid-cols-3 gap-4 mb-4",children:[e.jsxs(c,{children:[e.jsx(n,{className:"text-gray-700 dark:text-white",children:"Product Name *"}),e.jsx(d,{name:"productName",control:t,render:({field:r})=>e.jsx(o,{...r,type:"text",placeholder:"Enter product name",className:"dark:text-white dark:bg-gray-800"})}),a.productName&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:a.productName.message})]}),e.jsxs(c,{children:[e.jsx(n,{className:"text-gray-700 dark:text-white",children:"Brand *"}),e.jsx(d,{name:"brand",control:t,render:({field:r})=>e.jsx(o,{...r,type:"text",placeholder:"Enter Brand Name",className:"dark:text-white dark:bg-gray-800"})}),a.brand&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:a.brand.message})]}),e.jsxs(c,{children:[e.jsx(n,{className:"text-gray-700 dark:text-white",children:"Category *"}),e.jsx(d,{name:"category",control:t,render:({field:r})=>e.jsxs("select",{...r,className:"w-full p-3 border rounded-md dark:text-white dark:bg-gray-800",children:[e.jsx("option",{value:"",children:"Select category"}),k.map(s=>e.jsx("option",{value:s.categoryName,children:s.categoryName},s._id))]})}),a.category&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:a.category.message})]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mb-4",children:[e.jsxs(c,{children:[e.jsx(n,{className:"text-gray-700 dark:text-white",children:"Description *"}),e.jsx(d,{name:"description",control:t,render:({field:r})=>e.jsx(L,{...r,placeholder:"Enter product description",rows:"4",className:"dark:text-white dark:bg-gray-800"})}),a.description&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:a.description.message})]}),e.jsxs(c,{children:[e.jsx(n,{className:"text-gray-700 dark:text-white",children:"Product Image *"}),e.jsx(d,{name:"image",control:t,render:({field:r})=>e.jsx(O,{initialValue:r.value,onChange:r.onChange})}),a.image&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:a.image.message})]})]}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-4 mb-4",children:[e.jsxs(c,{children:[e.jsx(n,{className:"text-gray-700 dark:text-white",children:"Base Price *"}),e.jsx(d,{name:"basePrice",control:t,render:({field:{onChange:r,...s}})=>e.jsx(o,{...s,type:"number",placeholder:"Enter base price",onChange:l=>r(Number(l.target.value)),className:"dark:text-white dark:bg-gray-800"})}),a.basePrice&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:a.basePrice.message})]}),e.jsxs(c,{children:[e.jsx(n,{className:"text-gray-700 dark:text-white",children:"Base Offer Price"}),e.jsx(d,{name:"baseOfferPrice",control:t,render:({field:{onChange:r,...s}})=>e.jsx(o,{...s,type:"number",placeholder:"Enter base offer price",onChange:l=>r(Number(l.target.value)),className:"dark:text-white dark:bg-gray-800"})}),a.baseOfferPrice&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:a.baseOfferPrice.message})]}),e.jsxs(c,{children:[e.jsx(n,{className:"text-gray-700 dark:text-white",children:"Return Policy *"}),e.jsx(d,{name:"returnPolicy",control:t,render:({field:r})=>e.jsx(o,{...r,type:"text",placeholder:"Enter Return Policy",className:"dark:text-white dark:bg-gray-800"})}),a.returnPolicy&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:a.returnPolicy.message})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx(d,{name:"variants",control:t,render:({field:r})=>e.jsx(V,{variants:r.value,onChange:r.onChange,basePrice:P,baseOfferPrice:v,category:x("category")})}),a.variants&&e.jsx("p",{className:"text-red-500 text-sm mt-2",children:a.variants.message})]}),e.jsx("div",{children:e.jsxs("button",{type:"submit",disabled:h,className:"w-full dark:bg-blue-600 bg-orange-500 text-white px-6 py-3 rounded-md dark:hover:bg-blue-700 hover:bg-orange-600 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(T,{className:"mr-2"}),h?"Adding Product...":"Add Product"]})})]})]})})};export{Y as default};
